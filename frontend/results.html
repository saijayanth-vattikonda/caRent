<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
    <link
        href="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/build/css/tempusdominus-bootstrap-4.min.css"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./index.css" />
    <style>
        footer {
            min-height: calc(100vh- 529px);
        }
        .dropdown-item,
        li {
            color: #ff595a;
        }

        .card-body{
    background-color: #f1e1cc;
    border-radius: 5px;
        }

        .card-title,h5{
            color: #ff595a;
          
        }
        .card-title{
            font-weight: bold;
        }


        #logout:hover{
            color:red;
            background-color: #f1e1cc;
            font-size: larger;
            font-weight: bold;
            transition: 0.3s;
        }

        #navdropdown{
            background-color: #001233;
        }

    </style>
</head>

<body class="d-flex flex-column min-vh-100">

    <!-- nav bar in result page -->
    <nav class="navbar navbar-expand-lg  sticky-top shadow-sm" id="stylemyNav" style="background-color: #001233;">
        <div class="container-fluid" style="background-color: #001233;">
            <div class="container-fluid justify-content-center">
                <a class="navbar-brand  fs-1 fw-bold font-monospace" href="./index.html" style="color:#ff595a">
                    <img src="./assets/car.gif" alt="Logo" width="85" height="50"
                        class="d-inline-block align-text-top car-gif">
                    caRent
                </a>
            </div>
            <button class="navbar-toggler m-3 bg-white" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 fw-bold">
                    <li class="nav-item">
                        <a class="nav-link active fs-8" aria-current="page" href="index.html"
                            style="color:#ff595a">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle fs-8" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false" style="color: #ff595a;">
                            Welcome, 
                        </a>
                        <ul class="dropdown-menu" id="navdropdown">
                            <li><a class="dropdown-item" href="editProfile.html">Edit Profile</a></li>
                            <li><a class="dropdown-item" href="myBookings.html">My Bookings</a></li>
                            <li>
                                <hr class="dropdown-divider" style="background-color: #f1e1cc;">
                            </li>
                            <li><a class="dropdown-item" id="logout" onclick="handleLogout()" href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- nav ends here here -->



    <!-- Date time place Selector startes here  -->
    <div class="col-lg-12 container text-center">
        <h1 class="mt-5 mb-4 fw-bold">Rent a Car</h1>
        <form id="search-cars" method="post" action="/car/getData">
            <div class="row align-items-center">
                <div class="col-md-3 mb-3">
                    <select class="form-select" id="citySelect" aria-placeholder="Select City">
                        <option value="">Select City</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="input-group date" id="pickupDateTimePicker" data-target-input="nearest">
                        <input type="text" class="form-control datetimepicker-input" data-target="#pickupDateTimePicker"
                            placeholder="Select Pickup Date & Time" />
                        <div class="input-group-append" data-target="#pickupDateTimePicker"
                            data-toggle="datetimepicker">
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="input-group date" id="returnDateTimePicker" data-target-input="nearest">
                        <input type="text" class="form-control datetimepicker-input" data-target="#returnDateTimePicker"
                            placeholder="Select Return Date & Time" />
                        <div class="input-group-append" data-target="#returnDateTimePicker"
                            data-toggle="datetimepicker">
                            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-1 mb-3">
                    <button type="submit" class="btn search-button"
                            style="font-size: large; padding-top: 9px; padding-bottom: 8px;">Search</button>

                </div>
            </div>
        </form>
    </div>
    <!-- Date time place Selector ends herer here  -->



    <!-- cars cards demo show  -->
    <br>
    <div id="cardContainer" class="row row-cols-1 row-cols-md-3 g-4 border-3">
        <!-- <div class="col">
            <div class="card h-100 m-3">
                <img src="./images/samplecar.png" class="card-img-top" alt="samplecar">
                <div class="card-body">
                    <h5 class="card-title">Ford</h5>
                    <p class="card-text">This is a longer card with supporting text below as a natural lead-in to
                        additional content. This content is a little bit longer.</p>
                    <div class="container text-center">
                        <div class="row">
                            <div  class="col">
                                Manual
                            </div>
                            <div class="col">
                                Petrol
                            </div>
                            <div class="col">
                                Sedan
                            </div>
                        </div>
                    </div>
                    <br>
                    <h2>&#8377;500/h</h2>
                    <a href="#" class="btn btn-primary btn-lg result-btn"
                        style="position: absolute; bottom: 50px; right: 50px; padding-top: 7px; padding-bottom: 4px;"
                        data-bs-toggle="modal" data-bs-target="#myModal">Book
                        Now</a>
                </div>
            </div>
        </div> -->
        <!-- card with model start -->
        <!-- <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content" style="background-color:#001233;">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Ford</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <img src="./images/samplecar.png" class="card-img-top" alt="samplecar">
                        <p class="card-text">This is a longer card with supporting text below as a natural lead-in to
                            additional content. This content is a little bit longer.</p>
                        <div class="container text-center">
                            <div class="row">
                                <div class="col">
                                    Manual
                                </div>
                                <div class="col">
                                    Petrol
                                </div>
                                <div class="col">
                                    4 seater
                                </div>
                                <div class="col">
                                    Sedan
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <h2 style="position: absolute; left: 20px; bottom: 10px;">&#8377;500/h</h2>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Confirm</button>
                    </div>

                </div>
            </div>
        </div>   -->
    </div>
    <!-- cars cards demo show  end ended-->



    <!-- Footer start here  -->
    <br>
    <br>
    <footer class="footer mt-auto py-5" style="background-color: #182847">
        <div class="container" style="background-color: #182847;">
            <div class="row">
                <div class="col-md-5 pr-4 mb-4">
                    <img src="./assets/car.gif" alt="logo" width="80" height="50">
                    <h3 class="mt-3 fs-1 fw-bold font-monospace" style="color: #ff595a;">caRent</h3>
                    <p class="nT">Experience luxury and ease with our premium car rental service.
                        Welcome to your destination for exceptional driving experiences.</p>
                </div>
                <div class="col-md-2 mb-4">
                    <h5 style="color: #ff595a; font-weight: bold;">USEFUL LINKS</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item mb-2" class="nT"><a href="#" class="nav-link footer-text p-0 ">Home</a></li>
                        <li class="nav-item mb-2" class="nT"><a href="#about"
                                class="nav-link footer-text p-0 ">About</a></li>
                        <li class="nav-item mb-2" class="nT"><a href="#testimonial"
                                class="nav-link footer-text p-0 ">Testimonials</a>
                        </li>
                        <li class="nav-item mb-2" class="nT"><a href="#roadmap" class="nav-link footer-text p-0 ">Get
                                Started
                            </a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-4">
                    <h5 style="color: #ff595a; font-weight: bold;">Subscribe to our newsletter</h5>
                    <p class="nT"> Monthly digest of what's new and exciting from us.</p>
                    <div class="input-group">
                        <input id="newsletter1" type="email" class="form-control" placeholder="Email address">
                        <button class="btn subscribe-button" type="submit">Subscribe</button>
                    </div>
                </div>
            </div>

            <div class="border-top pt-4 ">
                <p class="text-center" style="color: #f1e1cc;">©️ 2024 Company, Inc. All rights reserved.</p>
                <ul class="list-unstyled d-flex justify-content-center ">&emsp;
                    <li class="me-5  ms-5 "><a class="link-dark" href="#"><i class="bi bi-twitter-x"></i></a></li>
                    <li class="me-5"><a class="link-dark" href="#"><i class="bi bi-instagram"></i></a></li>
                    <li class="me-5"><a class="link-dark" href="#"><i class="bi bi-facebook"></i></i></a></li>
                    <li class="me-5"><a class="link-dark" href="#"><i class="bi bi-linkedin"></i></a></li>
                </ul>
            </div>
        </div>
    </footer>
    <!-- Footer ends here here -->


<script src="results.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://kit.fontawesome.com/e9531eec98.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tempusdominus-bootstrap-4@5.39.0/build/js/tempusdominus-bootstrap-4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script>

  $(document).ready(function(){
    fetchCities();
    $('#pickupDateTimePicker').datetimepicker({
      format: 'YYYY-MM-DD HH:mm', 
      minDate: new Date()
    });
    $('#returnDateTimePicker').datetimepicker({
      format: 'YYYY-MM-DD HH:mm', 
      minDate: new Date()
    });
  }); 


  function fetchCities() {
    const xhr = new XMLHttpRequest();
    
    // Configure the request
    xhr.open('GET', './assets/cities.json', true);
    
    // Set up callback function
    xhr.onload = function() {
      if (xhr.status >= 200 && xhr.status < 300) {
        const response = JSON.parse(xhr.responseText);
        const cities = response.cities; // Access the 'cities' array
        console.log('Fetched cities:', cities); // Log the fetched data
        populateSelect(cities);
      } else {
        console.error('Request failed with status:', xhr.status);
      }
    };
    
    xhr.send();
}


      function populateSelect(cities) {
      const select = document.getElementById('citySelect');
      
      cities.forEach(function(city) {
        const option = document.createElement('option');
        option.value = city.id; // Assuming each city object has an 'id' property
        option.textContent = city.name; // Assuming each city object has a 'name' property
        select.appendChild(option);
      });
    }

    async function handleLogout(){
        
        const result = await fetch("https://carent-api.vercel.app/user/logout", {
            method: "POST",
            headers: {
            "Content-Type": "application/json",
            },
        }).then(res => res.json())

        if(result.status === "ok"){
            localStorage.setItem("isLoggedIn", false)
            window.location.href = result.redirectTo;
        }


    }


  // Function to retrieve username from local storage
        function getUsername() {
            // Retrieve the username from local storage
            const username = localStorage.getItem('username');
            return username;
        }

        // Function to update the welcome message in the navigation bar
        function updateWelcomeMessage() {
            const welcomeMessage = document.querySelector('.navbar .dropdown .nav-link');
            const username = getUsername();
            // Update the welcome message with the username
            welcomeMessage.textContent = `Welcome, ${username}`;
        }

        // Call the function to update the welcome message when the page loads
        window.onload = updateWelcomeMessage;
        
</script>
</body>
</html>